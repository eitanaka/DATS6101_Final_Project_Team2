---
title: "Lifecycle and mental health"
author: "Ishani Makwana, Henry Hirsch and Ei Tanaka"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r setup, include=FALSE}
# Some of common RMD options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
# Can globally set option for number display format.
options(scientific=T, digits = 3) 
# options(scipen=9, digits = 3) 
```

```{r}
# Import Libraries
rm(list=ls())
library(readr)
library(ggplot2)
library(tidyr)
library(corrplot)
library(ezids)
```

```{r init}
url <- 'https://raw.githubusercontent.com/eitanaka/DATS6101_Final_Project_Team2/main/data_set/geo_socio_health_df.csv'
master_df<- read_csv(url)
```

## Abstract
Need edited

## Introcuction
In project 1, we investigated how health risk behaviors are associated with health outcomes and health status. Now we are trying to examine whether there is any significant influence on mental health due to lifestyle, socio-economic factors, and covid-19 in the United States. Census tracts will be used in calculating and analyzing all the different datasets. This research will help us in identifying and expecting what factors have significantly impacted mental health and well-being in the United States in 2020.  


### Data sets
Need edited (Describe about 4 data set and how we create)

### Variables of interest
CountyFIPS: a numeric column containing the FIPS code for each county.
GEOID: a numeric column containing the unique  Geographical ID for each county.
StateAbbr: a character column containing the abbreviation for the state where each county is located.
CountyName: a character column containing the name of each county.
BINGE: a numeric columns representing percentages of population in each county that reported binge drinking
DEPRESSION:a numeric columns representing percentages of population in each county that reported depression
LPA:a numeric columns representing percentages of population in each county that reported doing less physical activity
MHLTH:a numeric columns representing percentages of population in each county that reported poor mental health
SLEEP:a numeric columns representing percentages of population in each county that reported insufficient sleep.
MT_Total: Total marital status percentage.
MT_Never Married:a numeric columns representing percentages of adults in each county who were categorized as never married
MT_Now married:a numeric columns representing percentages of adults in each county who were categorized as now married.
MT_Divorces:a numeric columns representing percentages of adults in each county who were categorized as got divorces.
MT_Separated:a numeric columns representing percentages of adults in each county who were categorized as couple who separated.
MT_Widowed:a numeric columns representing percentages of adults in each county who were categorized as widowed.
EA_Total: Total educational population percentage.
EA_Less than high school graduate:a numeric columns representing percentages of adults in each county who were categorized as studied less than high school
EA_High school graduate: a numeric columns representing percentages of adults in each county who were categorized who are high school graduate.
EA_college or associate's degree:a numeric columns representing percentages of adults in each county who were categorized who did college or associate's degree
EA_Bachelor's degree: a numeric columns representing percentages of adults in each county who were categorized as completed bachelor's degree
EA_Graduate or professional degree:a numeric columns representing percentages of adults in each county who were categorized as having a certain educational graduate or professional degree.
MI_Estimate:a numeric column representing the estimated median household income in each county.
Total Population:a numeric column representing the total population of each county.
CT_Total:a numeric column representing the percentages of the population in each county that take total commute time in percentage.
CT_<10:a numeric column representing the percentages of the population in each county that take commute time less than 10min
CT_10-14:a numeric column representing the percentages of the population in each county that take commute time between 10 -14min
CT_20-24:a numeric column representing the percentages of the population in each county that take commute time between 20 -24min
CT_25-29:a numeric column representing the percentages of the population in each county that take commute time between 25 -29min
CT_30-34:a numeric column representing the percentages of the population in each county that take commute time between 30 -34min
CT_35-44:a numeric column representing the percentages of the population in each county that take commute time between 35 -44min
CT_45-54:a numeric column representing the percentages of the population in each county that take commute time between 45 -54min
CT_55-59:a numeric column representing the percentages of the population in each county that take commute time between 55 -59min
CT_>60:a numeric column representing the percentages of the population in each county that take commute time more than 60 minutes

ES_Total: This variable represents the percentage of the total population that is employed or actively seeking employment.
ES_Total_labor_force: This variable represents the percentage of the total population that is either employed or actively seeking employment out of the total labor force.
ES_Civilian_labor_force: This variable represents the percentage of the total population that is either employed or actively seeking employment within the civilian labor force.
ES_Civilian_labor_force_employed: This variable represents the percentage of the total civilian labor force that is currently employed.
ES_Civilian_labor_force_unemployed: This variable represents the percentage of the total civilian labor force that is currently unemployed and actively seeking employment.
ES_Armed_Forces: This variable represents the percentage of the total population that is serving in the armed forces.
ES_Not_in_labor_force: This variable represents the percentage of the total population that is not part of the labor force, either due to being retired, not seeking employment, or being unable to work.
LAND_AREA: This variable represents the total land area in square kilometers.
URBANIZED_AREA_POP_CEN_2010: This variable represents the population in urbanized areas as of the 2010 Census.
URBAN_CLUSTER_POP_CEN_2010: This variable represents the population in urban clusters as of the 2010 Census.
RURAL_POP_CEN_2010: This variable represents the rural population as of the 2010 Census.
pct_URBANIZED_AREA_POP_CEN_2010: This variable represents the percentage of the total population living in urbanized areas as of the 2010 Census.
pct_URBAN_CLUSTER_POP_CEN_2010: This variable represents the percentage of the total population living in urban clusters as of the 2010 Census.
pct_RURAL_POP_CEN_2010: This variable represents the percentage of the total population living in rural areas as of the 2010 Census.
index_apr20: This variable represents an index value for the area in question as of April 2020.
pop.den: This variable represents the population density of the area in question.

### Initial SMART Question
Need edited
1) Why does the United States have a large number of people with depression and mental health issues? Is the lifestyle, socio-economic factors, and covid-19 in the States leading people towards poor mental health?

2) How can we expect predictors to contribute to increased depression and poor mental health?

## EDA
Need edited
```{r}
# checking normality of dependent variables
master_df <- na.omit(master_df)
colnames(master_df)[colnames(master_df) == "MT_Never Married"] <- "MT_never_married"
colnames(master_df)[colnames(master_df) == "MT_Now married"] <- "MT_now_married"
colnames(master_df)[colnames(master_df) == "Total Population"] <- "total_population"
colnames(master_df)[colnames(master_df) == "EA_Less than high school graduate"] <- "EA_Less_than_high_school_graduate"
colnames(master_df)[colnames(master_df) == "EA_High school graduate"] <- "EA_High_school_graduate"
colnames(master_df)[colnames(master_df) == "EA_college or associate's degree"] <- "EA_college_or_associates_degree"
colnames(master_df)[colnames(master_df) == "EA_Bachelor's degree"] <- "EA_Bachelors_degree"
colnames(master_df)[colnames(master_df) == "EA_Graduate or professional degree"] <- "EA_Graduate_or_professional_degree"

# histograms
dep_hist <- hist(master_df$DEPRESSION, main = "Distribution of Tract-level Depression Rates")
mhlth_hist <- hist(master_df$MHLTH, main = "Distribution of Tract-level Poor Mental Health Rates")
dep_hist
mhlth_hist

# qqplots
dep_qq <- qqnorm(master_df$DEPRESSION, main = "Distribution of Tract-level Depression Rates")
mhlth_qq <- qqnorm(master_df$MHLTH, main = "Distribution of Tract-level Poor Mental Health Rates")
dep_qq
mhlth_qq

# create data frame of only numeric values
cols_to_remove <- c("...1", "CountyFIPS", "GEOID", "StateAbbr", "CountyName", "MT_Total", "EA_Total", "total_population", "CT_Total", "ES_Total", "LAND_AREA")
num_df <- master_df[ , !names(master_df) %in% cols_to_remove]

# hist_list <- lapply(names(num_df), function(col) {
#   ggplot(num_df, aes_string(x = col)) +
#     geom_histogram() +
#     ggtitle(col)
# })
# hist_list
```


#### Handle Null Values
```{r}
master_df <- na.omit(master_df)
colSums(is.na(master_df[6:length(master_df)]))
```

### Basic EDA
Need edited

#### Handle Outlier
```{r}
```

## Data Structure
Need edited
```{r}
str(master_df)
```


## Summary Statictics
Need edited
```{r}
summary(master_df)
```

### Descriptive Statistics
Need edited 

### Hypothesis Testing
Need edited

### Correlations
```{r}
cor_matrix <- cor(master_df[,6:length(master_df)])
View(cor_matrix)

# Create 6 subset for cor_matrix or cor_heatmap
dep_mth_df <- subset(master_df, select = "DEPRESSION")
dep_mth_df <- cbind(dep_mth_df, master_df[,9])

# Data frame containing depression, mhlth, health risk behaviors
dep_mth_hrb <- dep_mth_df
dep_mth_hrb["BINGE"] <- master_df[,6]
dep_mth_hrb["LPA"] <- master_df[,8]
dep_mth_hrb["SLEEP"] <- master_df[,10]

# Data frame containing depression, mhlth, MT
dep_mth_mt <- cbind(dep_mth_df, master_df[12:16])
# Data frame containing depression, mhlth, EA, MI, Pop
dep_mth_ea_mi_pop <- cbind(dep_mth_df, master_df[18:24])
# Data Frame containing depression, mhlth, MI, Pop, CT
dep_mth_ct <- cbind(dep_mth_df, master_df[26:34])
# Data Frame containing depression, mhlth, ES 
dep_mth_es <-cbind(dep_mth_df, master_df[36:41])
# Data Frame containing depression, mhlth, others
dep_mth_geo <- cbind(dep_mth_df, master_df[42:length(master_df)])

# A set of cormatrix
cor_matrix_HRB <- cor(dep_mth_hrb)
cor_matrix_MT_EA <- cor(dep_mth_mt)
cor_matrix_EA_MI_POP <- cor(dep_mth_ea_mi_pop)
cor_matrix_CT <- cor(dep_mth_ct)
cor_matrix_ES <- cor(dep_mth_es)
cor_matrix_GEO <- cor(dep_mth_geo)

# Plot
corrplot(cor_matrix_HRB, method = "circle", type = "upper", order = "hclust", addCoef.col = "black", tl.col = "black", tl.srt = 45, cl.pos = "n")
corrplot(cor_matrix_MT_EA, method = "circle", type = "upper", order = "hclust", addCoef.col = "black", tl.col = "black", tl.srt = 45, cl.pos = "n")
corrplot(cor_matrix_EA_MI_POP, method = "circle", type = "upper", order = "hclust", addCoef.col = "black", tl.col = "black", tl.srt = 45, cl.pos = "n")
corrplot(cor_matrix_CT, method = "circle", type = "upper", order = "hclust", addCoef.col = "black", tl.col = "black", tl.srt = 45, cl.pos = "n")
corrplot(cor_matrix_ES, method = "circle", type = "upper", order = "hclust", addCoef.col = "black", tl.col = "black", tl.srt = 45, cl.pos = "n")
corrplot(cor_matrix_GEO, method = "circle", type = "upper", order = "hclust", addCoef.col = "black", tl.col = "black", tl.srt = 45, cl.pos = "n")
```

### Variable Selection
Need edited
```{r}

```

### Hypothesis Testing
Need edited
```{r}
```

### EDA Interpretation?
Need edited

## Model Building
Need edited
```{r}

```

### Check Assumption for Model Buiding?
Need edited

### Building Model
Need edited

### Model Assessment?
Need edited

## Result
Need edited

## Discussion
Need edited

### Limitations
Need edited

### Further Research
Need edited

## Conclusion
Need edited

## References
Need edited
# Reference links to datasets:
https://chronicdata.cdc.gov/500-Cities-Places/PLACES-Local-Data-for-Better-Health-Census-Tract-D/cwsq-ngmh
https://gisgeography.com/us-county-map/
https://www.ers.usda.gov/data-products/county-level-data-sets/county-level-data-sets-download-data/
https://data.census.gov/
https://www.anl.gov/dis/county-economic-impact-index
https://www.census.gov/programs-surveys/community-resilience-estimates/data/datasets.html
https://github.com/NREL/hsds-examples

